#!/usr/bin/env bash

user=rwxrob
channels=rwxrob

echo "Generate your OAuth token here: https://twitchapps.com/tmi/"
read -rp "Paste (starting with 'oauth:'): " token

mkdir -p ~/.weechat
fifo=~/.weechat/fifo
if [[ ! -p "$fifo" ]]; then
	echo "Error: WeeChat FIFO pipe not found at $fifo."
	echo "Enable it in WeeChat with: /set fifo.pipe.enabled on"
	echo "You may also need to set the pipe path: /set fifo.pipe.path $fifo"
	exit 1
fi

cat <<EOF >"$fifo"
*/set weechat.color.chat_bg 235
*/set weechat.color.chat_fg 223
*/set weechat.color.chat_prefix_error 124
*/set weechat.color.chat_prefix_network 66
*/set weechat.color.chat_prefix_action 214
*/set weechat.color.chat_highlight 142
*/set weechat.color.chat_read_marker 214
*/set weechat.color.chat_host 243
*/set weechat.color.chat_buffer 214
*/set weechat.color.separator 243
*/set weechat.look.prefix_join "ðŸ‘‹"
*/set weechat.look.prefix_action "âœ¨"
*/set weechat.look.prefix_error "ðŸ¤¬"
*/bar hide buflist
*/bar hide status
*/bar hide title
*/bar hide input
*/server add twitch irc.chat.twitch.tv/6667 -ssl
*/set irc.server.twitch.autoconnect on
*/set irc.server.twitch.username "$user"
*/set irc.server.twitch.password "$token"
*/set irc.server.twitch.autojoin "#${channels//,/,#}"
*/save
EOF
