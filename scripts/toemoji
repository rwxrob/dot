#!/usr/bin/env bash

declare -A emoji
emoji[smile]=ðŸ˜ƒ
emoji[bear]=ðŸ»
emoji[hamburger]=ðŸ”
emoji[lightbulb]=ðŸ’¡
emoji[idea]=ðŸ’¡
emoji[comment]=ðŸ’¬
emoji[chat]=ðŸ’¬
emoji[pomo]=ðŸ…
emoji[stop]=ðŸ›‘
emoji[warning]=âš ï¸
emoji[rant]=ðŸ¤¬
emoji[tv]=ðŸ“º
emoji[update]=ðŸ“°
emoji[tux]=ðŸ§
emoji[tux]=ðŸ§
emoji[leftarrow]=â†
emoji[poop]=ðŸ’©
emoji[yoga]=ðŸ§˜
emoji[facepalm]=ðŸ¤¦
emoji[tree]=ðŸŒ³

toemoji() {
	local in=/dev/stdin
	local out=/dev/stdout
	local file="$1"
	if [[ -n $file ]]; then
		in="$file"
		out="$(mktemp)"
	fi
	IFS=$'\n'
	while read -r line; do
		for k in "${!emoji[@]}"; do
			line=${line//:$k:/${emoji[$k]}}
			[[ $line =~ ^--- ]] && continue
			line=${line//---/â€”}
			line=${line//:bullet:/â€¢}
		done
		echo "$line" >>"$out"
	done <"$in"
	if [[ -n $file ]]; then
		cp "$out" "$file"
		rm "$out"
	fi
}

toemoji "$@"
