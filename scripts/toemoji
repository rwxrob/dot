#!/usr/bin/env bash

declare -A emoji
emoji[smile]=ğŸ˜ƒ
emoji[bear]=ğŸ»
emoji[hamburger]=ğŸ”
emoji[lightbulb]=ğŸ’¡
emoji[idea]=ğŸ’¡
emoji[comment]=ğŸ’¬
emoji[chat]=ğŸ’¬
emoji[pomo]=ğŸ…
emoji[stop]=ğŸ›‘
emoji[warning]=âš ï¸
emoji[rant]=ğŸ¤¬
emoji[tv]=ğŸ“º
emoji[update]=ğŸ“°
emoji[tux]=ğŸ§
emoji[tux]=ğŸ§
emoji[leftarrow]=â†
emoji["<--"]=â†
emoji[rightarrow]=â†’
emoji["-->"]=â†’
emoji[poop]=ğŸ’©
emoji[yoga]=ğŸ§˜
emoji[facepalm]=ğŸ¤¦
emoji[tree]=ğŸŒ³

toemoji() {
	local in=/dev/stdin
	local out=/dev/stdout
	local file="$1"
	if [[ -n $file ]]; then
		in="$file"
		out="$(mktemp)"
	fi
	IFS=$'\n'
	while read -r line; do
		for k in "${!emoji[@]}"; do
			line=${line//:$k:/${emoji[$k]}}
			[[ $line =~ ^--- ]] && continue
			line=${line//---/â€”}
			line=${line//--\>/â†’}
			line=${line//:bullet:/â€¢}
		done
		echo "$line" >>"$out"
	done <"$in"
	if [[ -n $file ]]; then
		cp "$out" "$file"
		rm "$out"
	fi
}

toemoji "$@"
